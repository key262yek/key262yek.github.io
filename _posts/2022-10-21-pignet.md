---
title: "Paper review : PIGNet"
date: 2022-10-20
categories:
  - Review
tags:
  - Deep Learning
  - GNN
  - Drug design
  - Unfinished
toc: true
toc_label: "Table of Contents"
toc_icon: "fas fa-clipboard-list"
toc_sticky: true
---

## Paper information
Seokhuyn Moon, Wonho Zhung, Soojung Yang, Jaechang Lim, and Woo Youn Kim. 
"PIGNet: a physics-informed deep learning model toward generalized drug–target interaction predictions".
[*Chem. Sci.*, 2022, **13**, 3661]("")

## Abstract
Recently, deep neural network (DNN)-based drug–target interaction (DTI) models were highlighted for theirhigh accuracy with affordable computational costs. Yet, the models' insufficient generalization remainsa challenging problem in the practice ofin silicodrug discovery. We propose two key strategies toenhance generalization in the DTI model. Thefirst is to predict the atom–atom pairwise interactionsviaphysics-informed equations parameterized with neural networks and provides the total binding affinity ofa protein–ligand complex as their sum. We further improved the model generalization by augmentinga broader range of binding poses and ligands to training data. We validated our model, PIGNet, in thecomparative assessment of scoring functions (CASF) 2016, demonstrating the outperforming dockingand screening powers than previous methods. Our physics-informing strategy also enables theinterpretation of predicted affinities by visualizing the contribution of ligand substructures, providinginsights for further ligand optimization.

## Purpose
생리, 약학 분야에서 DNN은 분야 특성상 부족하고, 치우쳐있는 데이터 분포 때문에 다른 분야에서의 성공만큼 잘하지는 못하고 있습니다. 
그 중에서 약물-단백질간 상호작용을 예측하는 문제는 약물 후보를 걸러내는데 핵심적인 과제이면서도 아직 도전적인 영역입니다. 

DNN 이전에 이 영역에서 다음과 같은 시도가 있었습니다.
- Docking method : 가장 많이 시도되는 방법으로 계산 비용이 저렴하지만 정확도가 떨어진다. 
- Thermodynamic integration : 좀더 엄밀하지만 계산 비용이 많이 비싸다. 

이처럼 물리학 기반의 접근은 계산비용과 정확도 사이 명확한 tradeoff가 존재합니다.
하지만 자료기반 접근은 더 많은 자료를 활용함으로써 거의 비슷한 계산비용으로도 정확도를 높일 수 있으므로, 이러한 한계를 돌파할 수 있는 수단으로 꼽히고 있습니다.

약물과 단백질의 위치정보는 이들간의 상호작용에서 매우 중요한 역할을 하기 때문에, 그 중에서도 공간 정보를 활용하는 3D-CNN Model이나, GNNs, Atomic environment vector 등의 연구가 이어져왔습니다.

하지만 앞서 언급했듯이 부족한 자료는 모델의 충분한 확장성을 보장하지 못했고, 학습 자료에 과적합되는 일이 부지기수였습니다.
Chen et al[^1] 에서는 DUD-E 자료를 이용한 학습 결과에서 receptor, ligand를 동시에 사용한 모델과 ligand만 사용한 모델의 성능이 매우 유사함을 지적하면서, 모델들이 오직 ligand에 대한 정보만을 이용해 추론하고 있고, 그에 따라 학습한 구조들과 차이가 큰 단백질에 관한 추론에서 그 성능이 크게 떨어짐을 보였습니다. 

[^1]: Chen et al. "Hidden bias in the DUD-E dataset leads to misleading performance of deep learning in structure-based virtual screening". *PLoS one*, 2019, **14**, e0220113.

이 논문에서는 학습하지 않은 상황으로의 확장성을 위해 모델이 '물리 법칙'을 학습하도록 했습니다. 물리 법칙은 모든 곳에서 동일하게 작용해야하므로, 물리 법칙을 학습한 모델도 미처 학습하지 못한 처음 보는 상황에서도 좋은 성능을 보일 것이라 기대한 것입니다.

## Contribution
### PIGNet
Physics-Informed Graph neural Network의 약어인 PIGNet은 반데르발스 상호작용, 수소 결합, 금속결합, 소수 결합의 합성을 통해 binding affinity를 예측하는 모델입니다. 
이론적으로 깊게 연관되었고, 검증된 물리량들을 활용함으로써 더 넓은 영역에서 확장가능하도록 할 수 있으며, 각 원자들간의 상호작용까지 추적할 수 있기 때문에 binding에 크게 기여하는 영역을 찾는다던가, 이후 affinity를 키우기 위한 방향성을 제시하는 데에도 활용할 수 있습니다. 

### Data augmentation
실제 모델을 활용할 때는 약물-단백질의 정확한 crystal structure를 알고 있지 못합니다. 따라서 조금의 오차를 허용하는 학습 자료를 구성할 필요가 있지만 실제로는 거의 존재하지 않죠. 이 논문에서는 무작위적으로 생성한 결합 구조를 학습시킴으로써 부정확한 결합구조를 사용할 때의 정확도를 개선하려고 하였습니다. 


## Network characteristics
3D CNN은 입자간 상호작용을 특정짓지 못한다는 문제가 있기 때문에, 상호작용 정보와 위치 정보를 함께 담을 수 있고 평행이동이나 회전에 대해 불변인 GNNs을 이용했습니다.

또 Greydanus et al[^2], Pun et al[^3]에서 물리학적 시스템을 예측할 때 이들의 governing equation의 parameter들을 학습하는 네트워크를 구성했을 때 그 확장성이 높아짐을 확인한 바 있습니다. 이러한 Hamiltonian neural networks를 이용해 각 원소간 상호작용을 직접 예측하도록 하였습니다. 

[^2]: S. Greydanus et al, "Hamiltonian Neural Networks", *NeurlIPS*, 2019, vol. **32**, pp. 15379–15389.
[^3]: G. P. Pun et al, "Physically informed artificial neural networks for atomistic modeling of materials", *Nat. Commun.*, 2019, **10**, 2339.
### Input / Output

### Network Architecture
<img src="https://key262yek.github.io/assets/images/pignet_model_architecture.png" alt="Network Architecture" width="400"/>


## Results, Discussion


## Reference

